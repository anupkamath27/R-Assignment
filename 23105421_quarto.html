<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MS130_3rd_Assignment_23105421</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="23105421_quarto_files/libs/clipboard/clipboard.min.js"></script>
<script src="23105421_quarto_files/libs/quarto-html/quarto.js"></script>
<script src="23105421_quarto_files/libs/quarto-html/popper.min.js"></script>
<script src="23105421_quarto_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="23105421_quarto_files/libs/quarto-html/anchor.min.js"></script>
<link href="23105421_quarto_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="23105421_quarto_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="23105421_quarto_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="23105421_quarto_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="23105421_quarto_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="23105421_quarto_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="23105421_quarto_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="23105421_quarto_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="23105421_quarto_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="23105421_quarto_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="23105421_quarto_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="23105421_quarto_files/libs/leaflet-1.3.1/leaflet.js"></script>
<link href="23105421_quarto_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="23105421_quarto_files/libs/proj4-2.6.2/proj4.min.js"></script>
<script src="23105421_quarto_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="23105421_quarto_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="23105421_quarto_files/libs/leaflet-binding-2.2.2/leaflet.js"></script>


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#part-a" id="toc-part-a" class="nav-link active" data-scroll-target="#part-a">Part A</a>
  <ul class="collapse">
  <li><a href="#reading-files" id="toc-reading-files" class="nav-link" data-scroll-target="#reading-files">Reading files</a></li>
  <li><a href="#preprosseing-dataset" id="toc-preprosseing-dataset" class="nav-link" data-scroll-target="#preprosseing-dataset">Preprosseing dataset</a></li>
  <li><a href="#joining-datasets" id="toc-joining-datasets" class="nav-link" data-scroll-target="#joining-datasets">Joining Datasets</a></li>
  <li><a href="#quantitative-analysis" id="toc-quantitative-analysis" class="nav-link" data-scroll-target="#quantitative-analysis">Quantitative Analysis</a></li>
  <li><a href="#quantitative-analysis-1" id="toc-quantitative-analysis-1" class="nav-link" data-scroll-target="#quantitative-analysis-1">Quantitative Analysis</a></li>
  </ul></li>
  <li><a href="#part-b" id="toc-part-b" class="nav-link" data-scroll-target="#part-b">Part B</a>
  <ul class="collapse">
  <li><a href="#mermaid-design" id="toc-mermaid-design" class="nav-link" data-scroll-target="#mermaid-design">Mermaid design</a></li>
  <li><a href="#leaflet-analysis" id="toc-leaflet-analysis" class="nav-link" data-scroll-target="#leaflet-analysis">Leaflet Analysis</a>
  <ul class="collapse">
  <li><a href="#geographical-analysis" id="toc-geographical-analysis" class="nav-link" data-scroll-target="#geographical-analysis">Geographical Analysis</a></li>
  </ul></li>
  <li><a href="#interactive-plot" id="toc-interactive-plot" class="nav-link" data-scroll-target="#interactive-plot">Interactive plot</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MS130_3rd_Assignment_23105421</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="logo.png" title="University of Galway" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Author: Anup Kamath</figcaption>
</figure>
</div>
<section id="part-a" class="level1">
<h1>Part A</h1>
<section id="reading-files" class="level2">
<h2 class="anchored" data-anchor-id="reading-files">Reading files</h2>
<p>When you click the <strong>Render</strong> button a document will be generated that includes both content and the output of embedded code. You can embed code like this:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/ANUP KAMATH/Documents/GitHub/R-Assignment"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/ANUP KAMATH/Desktop"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/ANUP KAMATH/Desktop"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>file1<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"C:/Users/ANUP KAMATH/Desktop/children-born-per-woman.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(file1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       Entity Code Year Fertility.rate..Gapminder..v12..2017.
1 Afghanistan  AFG 1950                                  7.57
2 Afghanistan  AFG 1951                                  7.56
3 Afghanistan  AFG 1952                                  7.55
4 Afghanistan  AFG 1953                                  7.54
5 Afghanistan  AFG 1954                                  7.53
6 Afghanistan  AFG 1955                                  7.52</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>file2<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"C:/Users/ANUP KAMATH/Desktop/world-happiness-report.csv"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(file2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Country.name year Life.Ladder Log.GDP.per.capita Social.support
1  Afghanistan 2008       3.724              7.370          0.451
2  Afghanistan 2009       4.402              7.540          0.552
3  Afghanistan 2010       4.758              7.647          0.539
4  Afghanistan 2011       3.832              7.620          0.521
5  Afghanistan 2012       3.783              7.705          0.521
6  Afghanistan 2013       3.572              7.725          0.484
  Healthy.life.expectancy.at.birth Freedom.to.make.life.choices Generosity
1                            50.80                        0.718      0.168
2                            51.20                        0.679      0.190
3                            51.60                        0.600      0.121
4                            51.92                        0.496      0.162
5                            52.24                        0.531      0.236
6                            52.56                        0.578      0.061
  Perceptions.of.corruption Positive.affect Negative.affect
1                     0.882           0.518           0.258
2                     0.850           0.584           0.237
3                     0.707           0.618           0.275
4                     0.731           0.611           0.267
5                     0.776           0.710           0.268
6                     0.823           0.621           0.273</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>file3<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"C:/Users/ANUP KAMATH/Desktop/population_by_country_2020.csv"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(file3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Country..or.dependency. Population..2020. Yearly.Change Net.Change
1                   China        1440297825        0.39 %    5540090
2                   India        1382345085        0.99 %   13586631
3           United States         331341050        0.59 %    1937734
4               Indonesia         274021604        1.07 %    2898047
5                Pakistan         221612785        2.00 %    4327022
6                  Brazil         212821986        0.72 %    1509890
  Density..P.Km.. Land.Area..Km.. Migrants..net. Fert..Rate Med..Age
1             153         9388211        -348399        1.7       38
2             464         2973190        -532687        2.2       28
3              36         9147420         954806        1.8       38
4             151         1811570         -98955        2.3       30
5             287          770880        -233379        3.6       23
6              25         8358140          21200        1.7       33
  Urban.Pop.. World.Share
1        61 %     18.47 %
2        35 %     17.70 %
3        83 %      4.25 %
4        56 %      3.51 %
5        35 %      2.83 %
6        88 %      2.73 %</code></pre>
</div>
</div>
</section>
<section id="preprosseing-dataset" class="level2">
<h2 class="anchored" data-anchor-id="preprosseing-dataset">Preprosseing dataset</h2>
<p>You can add options to executable code like this</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#file 1 changes</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>subset_a_2020 <span class="ot">&lt;-</span> file1[file1<span class="sc">$</span>Year <span class="sc">==</span> <span class="dv">2020</span>, ]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subset_a_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 Entity Code Year Fertility.rate..Gapminder..v12..2017.
71          Afghanistan  AFG 2020                                  4.04
162             Albania  ALB 2020                                  1.70
235             Algeria  DZA 2020                                  2.54
308              Angola  AGO 2020                                  5.41
381 Antigua and Barbuda  ATG 2020                                  2.01
535           Argentina  ARG 2020                                  2.23</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>subset_a_2020 <span class="ot">&lt;-</span> subset_a_2020[, <span class="fu">c</span>(<span class="st">"Entity"</span>, <span class="st">"Code"</span>, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Fertility.rate..Gapminder..v12..2017."</span>)]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(subset_a_2020) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"code"</span>, <span class="st">"fertility_rate"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subset_a_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                country code fertility_rate
71          Afghanistan  AFG           4.04
162             Albania  ALB           1.70
235             Algeria  DZA           2.54
308              Angola  AGO           5.41
381 Antigua and Barbuda  ATG           2.01
535           Argentina  ARG           2.23</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#file 2 changes</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>subset_b_2020 <span class="ot">&lt;-</span> file2[file2<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2020</span>, ]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View the subset</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subset_b_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Country.name year Life.Ladder Log.GDP.per.capita Social.support
25       Albania 2020       5.365              9.497          0.710
52     Argentina 2020       5.901              9.850          0.897
80     Australia 2020       7.137             10.760          0.937
93       Austria 2020       7.213             10.851          0.925
118      Bahrain 2020       6.173             10.620          0.848
133   Bangladesh 2020       5.280              8.472          0.739
    Healthy.life.expectancy.at.birth Freedom.to.make.life.choices Generosity
25                              69.3                        0.754      0.007
52                              69.2                        0.823     -0.122
80                              74.2                        0.905      0.210
93                              73.6                        0.912      0.011
118                             69.7                        0.945      0.132
133                             65.3                        0.777     -0.009
    Perceptions.of.corruption Positive.affect Negative.affect
25                      0.891           0.679           0.265
52                      0.816           0.764           0.342
80                      0.491           0.769           0.205
93                      0.464           0.769           0.206
118                        NA           0.790           0.297
133                     0.742           0.582           0.332</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>subset_b_2020 <span class="ot">&lt;-</span> subset_b_2020[, <span class="fu">c</span>(<span class="st">"Country.name"</span>, <span class="st">"Healthy.life.expectancy.at.birth"</span>, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Freedom.to.make.life.choices"</span>, <span class="st">"Generosity"</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Perceptions.of.corruption"</span>)]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(subset_b_2020) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"life_expectancy"</span>, <span class="st">"freedom"</span>,<span class="st">"generosity"</span>,<span class="st">"corruption"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified subset</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subset_b_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       country life_expectancy freedom generosity corruption
25     Albania            69.3   0.754      0.007      0.891
52   Argentina            69.2   0.823     -0.122      0.816
80   Australia            74.2   0.905      0.210      0.491
93     Austria            73.6   0.912      0.011      0.464
118    Bahrain            69.7   0.945      0.132         NA
133 Bangladesh            65.3   0.777     -0.009      0.742</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#file 3 changes</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(file3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Country..or.dependency. Population..2020. Yearly.Change Net.Change
1                   China        1440297825        0.39 %    5540090
2                   India        1382345085        0.99 %   13586631
3           United States         331341050        0.59 %    1937734
4               Indonesia         274021604        1.07 %    2898047
5                Pakistan         221612785        2.00 %    4327022
6                  Brazil         212821986        0.72 %    1509890
  Density..P.Km.. Land.Area..Km.. Migrants..net. Fert..Rate Med..Age
1             153         9388211        -348399        1.7       38
2             464         2973190        -532687        2.2       28
3              36         9147420         954806        1.8       38
4             151         1811570         -98955        2.3       30
5             287          770880        -233379        3.6       23
6              25         8358140          21200        1.7       33
  Urban.Pop.. World.Share
1        61 %     18.47 %
2        35 %     17.70 %
3        83 %      4.25 %
4        56 %      3.51 %
5        35 %      2.83 %
6        88 %      2.73 %</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(file3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Country..or.dependency." "Population..2020."      
 [3] "Yearly.Change"           "Net.Change"             
 [5] "Density..P.Km.."         "Land.Area..Km.."        
 [7] "Migrants..net."          "Fert..Rate"             
 [9] "Med..Age"                "Urban.Pop.."            
[11] "World.Share"            </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>subset_c_2020 <span class="ot">&lt;-</span> file3[, <span class="fu">c</span>(<span class="st">"Country..or.dependency."</span>, <span class="st">"Population..2020."</span>, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Density..P.Km.."</span>)]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(subset_c_2020)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"population"</span>, <span class="st">"density_pkm"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subset_c_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        country population density_pkm
1         China 1440297825         153
2         India 1382345085         464
3 United States  331341050          36
4     Indonesia  274021604         151
5      Pakistan  221612785         287
6        Brazil  212821986          25</code></pre>
</div>
</div>
</section>
<section id="joining-datasets" class="level2">
<h2 class="anchored" data-anchor-id="joining-datasets">Joining Datasets</h2>
<p>The <code>echo: false</code> option disables the printing of code (only output is displayed).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#joining tables</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert country column to lowercase in all dataframes</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>subset_a_2020 <span class="ot">&lt;-</span> subset_a_2020 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">tolower</span>(country))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>subset_b_2020 <span class="ot">&lt;-</span> subset_b_2020 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">tolower</span>(country))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>subset_c_2020 <span class="ot">&lt;-</span> subset_c_2020 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">tolower</span>(country))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">#join data</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>country_data <span class="ot">&lt;-</span> subset_b_2020 <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(subset_a_2020, <span class="at">by =</span> <span class="st">"country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(subset_c_2020, <span class="at">by =</span> <span class="st">"country"</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">#show new dataset</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(country_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     country life_expectancy freedom generosity corruption code fertility_rate
1    albania            69.3   0.754      0.007      0.891  ALB           1.70
2  argentina            69.2   0.823     -0.122      0.816  ARG           2.23
3  australia            74.2   0.905      0.210      0.491  AUS           1.81
4    austria            73.6   0.912      0.011      0.464  AUT           1.54
5    bahrain            69.7   0.945      0.132         NA  BHR           1.94
6 bangladesh            65.3   0.777     -0.009      0.742  BGD           2.00
  population density_pkm
1    2877239         105
2   45267449          17
3   25550683           3
4    9015361         109
5    1711057        2239
6  164972348        1265</code></pre>
</div>
</div>
</section>
<section id="quantitative-analysis" class="level2">
<h2 class="anchored" data-anchor-id="quantitative-analysis">Quantitative Analysis</h2>
<p>###GLM model</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#quantitative analysis- glm model</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting corruption into factor inorder to run glm model</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>country_data <span class="ot">&lt;-</span> country_data <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">corruption_factor =</span> <span class="fu">ifelse</span>(corruption <span class="sc">&gt;</span> <span class="fl">0.6</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'corruption_factor' to a factor variable</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>corruption_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(country_data<span class="sc">$</span>corruption_factor)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(country_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     country life_expectancy freedom generosity corruption code fertility_rate
1    albania            69.3   0.754      0.007      0.891  ALB           1.70
2  argentina            69.2   0.823     -0.122      0.816  ARG           2.23
3  australia            74.2   0.905      0.210      0.491  AUS           1.81
4    austria            73.6   0.912      0.011      0.464  AUT           1.54
5    bahrain            69.7   0.945      0.132         NA  BHR           1.94
6 bangladesh            65.3   0.777     -0.009      0.742  BGD           2.00
  population density_pkm corruption_factor
1    2877239         105                 1
2   45267449          17                 1
3   25550683           3                 0
4    9015361         109                 0
5    1711057        2239              &lt;NA&gt;
6  164972348        1265                 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># running glm model</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and testing sets</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(country_data), <span class="dv">70</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> country_data[sample_indices, ]</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> country_data[<span class="sc">-</span>sample_indices, ]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the logistic regression model</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>glm_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(corruption_factor <span class="sc">~</span> freedom, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">data =</span> train_data)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the model</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = corruption_factor ~ freedom, family = binomial(link = "logit"), 
    data = train_data)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)    7.448      5.508   1.352    0.176
freedom       -7.542      6.432  -1.173    0.241

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 18.550  on 16  degrees of freedom
Residual deviance: 16.935  on 15  degrees of freedom
  (2 observations deleted due to missingness)
AIC: 20.935

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the model</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(glm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quantitative-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="quantitative-analysis-1">Quantitative Analysis</h2>
<p>###GAM model</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#gam model</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("gam")</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a GAM model</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>gam_model <span class="ot">&lt;-</span> <span class="fu">gam</span>(corruption <span class="sc">~</span> <span class="fu">s</span>(freedom ) <span class="sc">+</span> <span class="fu">s</span>(generosity), <span class="at">data =</span> country_data)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the model</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gam_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
corruption ~ s(freedom) + s(generosity)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.70340    0.01923   36.58   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
               edf Ref.df      F  p-value    
s(freedom)    2.23  2.803 12.819 2.96e-06 ***
s(generosity) 1.00  1.000  0.024    0.877    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =   0.31   Deviance explained = 33.9%
GCV = 0.030496  Scale est. = 0.028842  n = 78</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gam_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="part-b" class="level1">
<h1>Part B</h1>
<section id="mermaid-design" class="level2">
<h2 class="anchored" data-anchor-id="mermaid-design">Mermaid design</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[children-born-per-woman]-- import data --&gt; D[subset_a_2020]
    B[world-happiness-report]-- import data --&gt; E[subset_b_2020]
    C[population_by_country_2020]-- import data  --&gt; F[subset_c_2020]
    D[subset_a_2020]-- Preprocess data --&gt; M((country_data))
    E[subset_b_2020]-- Preprocess data  --&gt; M((country_data))
    F[subset_c_2020]-- Preprocess data --&gt; M((country_data))
    
   M((country_data))-- GLM model--&gt;G[GLM Model]
   G[GLM Model]-- variables--&gt;H[corruption &amp; Freedom]
    M((country_data))-- GAM model--&gt;I[GAM Model]
   I[GAM Model]-- variables--&gt;J[corruption,generosity &amp; Freedom]

</pre>
</div>
</div>
</div>
</div>
</section>
<section id="leaflet-analysis" class="level2">
<h2 class="anchored" data-anchor-id="leaflet-analysis">Leaflet Analysis</h2>
<p>###Adding Latitude and Longitude</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install required packages</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("readr")</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("dplyr")</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidyverse")</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">#if (!require("tm")) install.packages("tm")</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co">#if (!require("wordcloud")) install.packages("wordcloud")</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co">#if (!require("RColorBrewer")) install.packages("RColorBrewer")</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"leaflet"</span>)) <span class="fu">install.packages</span>(<span class="st">"leaflet"</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"countrycode"</span>)) <span class="fu">install.packages</span>(<span class="st">"countrycode"</span>)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countrycode)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("plotly")</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(country_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     country life_expectancy freedom generosity corruption code fertility_rate
1    albania            69.3   0.754      0.007      0.891  ALB           1.70
2  argentina            69.2   0.823     -0.122      0.816  ARG           2.23
3  australia            74.2   0.905      0.210      0.491  AUS           1.81
4    austria            73.6   0.912      0.011      0.464  AUT           1.54
5    bahrain            69.7   0.945      0.132         NA  BHR           1.94
6 bangladesh            65.3   0.777     -0.009      0.742  BGD           2.00
  population density_pkm corruption_factor
1    2877239         105                 1
2   45267449          17                 1
3   25550683           3                 0
4    9015361         109                 0
5    1711057        2239              &lt;NA&gt;
6  164972348        1265                 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>world_map <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert country names in anuata to lowercase</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>country <span class="ot">&lt;-</span> <span class="fu">tolower</span>(country_data<span class="sc">$</span>country)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert region names in world_map (which represents countries here) to lowercase</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>world_map<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="fu">tolower</span>(world_map<span class="sc">$</span>region)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># unique list of countries with their mean latitude and longitude</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>country_coords <span class="ot">&lt;-</span> world_map <span class="sc">%&gt;%</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">lat =</span> <span class="fu">mean</span>(lat), <span class="at">lon =</span> <span class="fu">mean</span>(long), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the coordinates</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>country_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(country_data, country_coords, <span class="at">by.x =</span> <span class="st">"country"</span>, <span class="at">by.y =</span> <span class="st">"region"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>non_matching <span class="ot">&lt;-</span> country_data[<span class="fu">is.na</span>(country_data<span class="sc">$</span>lat), <span class="st">"country"</span>]</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(non_matching)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "united kingdom" "united states" </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#US and UK latitude and logitude missing</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#adding lat &amp; long for US</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>lat <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(country_data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"united states"</span>, <span class="fl">37.0902</span>, country_data<span class="sc">$</span>lat)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>lon <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(country_data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"united states"</span>, <span class="sc">-</span><span class="fl">95.7129</span>, country_data<span class="sc">$</span>lon)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># adding lat &amp; long for Uk</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>lat <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(country_data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"united kingdom"</span>, <span class="fl">55.3781</span>, country_data<span class="sc">$</span>lat)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>lon <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(country_data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"united kingdom"</span>, <span class="sc">-</span><span class="fl">3.4360</span>, country_data<span class="sc">$</span>lon)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(country_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          country life_expectancy freedom generosity corruption code
84 united kingdom            72.7   0.885      0.203      0.490  GBR
85  united states            68.1   0.850      0.034      0.678  USA
86        uruguay            69.2   0.908     -0.084      0.491  URY
87      venezuela            66.9   0.612         NA      0.811  VEN
88         zambia            56.3   0.750      0.056      0.810  ZMB
89       zimbabwe            56.8   0.643     -0.009      0.789  ZWE
   fertility_rate population density_pkm corruption_factor        lat       lon
84           1.87   67948282         281                 0  55.378100  -3.43600
85           1.89  331341050          36                 1  37.090200 -95.71290
86           1.95    3475842          20                 0 -32.297261 -56.01837
87           2.23   28421581          32                 1   7.398184 -65.79782
88           4.76   18468257          25                 1 -12.504296  28.81300
89           3.47   14899771          38                 1 -19.147785  29.64059</code></pre>
</div>
</div>
<section id="geographical-analysis" class="level3">
<h3 class="anchored" data-anchor-id="geographical-analysis">Geographical Analysis</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>world_map_leaflet <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(<span class="at">data =</span> country_data) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>(<span class="at">lng =</span> <span class="dv">0</span>, <span class="at">lat =</span> <span class="dv">30</span>, <span class="at">zoom =</span> <span class="dv">2</span>)  </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>world_map_leaflet <span class="ot">&lt;-</span> world_map_leaflet <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">lng =</span> <span class="sc">~</span>lon,  </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat =</span> <span class="sc">~</span>lat,  </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="st">"&lt;b&gt;Country:&lt;/b&gt; "</span>, country, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"&lt;b&gt;Population:&lt;/b&gt; "</span>, population, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"&lt;b&gt;Corruption:&lt;/b&gt; "</span>, corruption)  </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>world_map_leaflet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-0bb2780fb795d1b48284" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0bb2780fb795d1b48284">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[[41.09708418044369,-37.65934036372371,-25.18299682124491,47.57973189914928,26.05096186124361,23.50905165572961,50.59062728413775,9.734187972788908,-16.55725036739733,44.06762441870284,-9.802374640273657,42.62485704475275,12.59715425914229,6.2606792647498,65.29312210129154,-44.84064491534399,35.08243543758604,3.471104794416583,44.64204021188664,35.06383926391602,55.70473306131043,18.82517881052835,-1.643067240732472,27.6763009761162,13.850656393412,58.53493857750526,9.187706951273988,63.95119464961117,46.16686105018805,42.06423494292468,51.20460854785543,8.321272399568338,38.35875267119733,47.23226486633871,65.30841881286756,23.39336982137758,33.29490974993745,33.78998017208771,53.49476024082729,31.8765000479562,42.16598249235486,35.47392830548769,31.32931371529897,47.90227476086533,0.5784225319574277,40.91947045277075,18.43688927919437,56.86747880663191,55.08303815780148,35.96162700653076,-20.29733768262361,24.21141486238376,47.06327952954593,47.77825516721477,42.8171734602555,28.48567085680754,18.80447879030132,-21.82045585956979,52.09904686948087,-40.86267866811445,8.553471381847675,41.63620866375205,69.87699814611479,11.45729613843372,51.40997793704648,39.93083947704685,63.54476059433037,23.17242342835173,44.25244720687581,46.12320394226999,-28.84654387737291,35.73691086402306,40.67995297908783,61.89590923058444,46.74156613273416,38.95632402166765,-6.550021064408282,13.24865417579466,34.21880424663585,39.06608086718359,1.384924265524993,48.47919870899842,24.25769825711276,55.3781,37.0902,-32.29726104469566,7.398183538169457,-12.50429605489068,-19.14778542799108],[20.10925137680189,-65.45939024557163,136.9985434157885,13.47336568551905,50.5497066791241,90.50611803929012,4.73210363007762,2.359138491607847,-65.12439570814799,18.13478914025712,-55.28056799486398,24.96409570704625,105.1177878401398,13.01387305395944,-89.7561759006016,-72.31060274909524,106.8475748294394,-72.76286862099343,16.34878585682833,33.35030769348145,10.73125458083697,-70.50557947158813,-81.62440596258949,30.79317359773538,-88.81602921357026,24.59475612151317,38.9589723245987,24.43022350839057,3.226979203100416,43.87005075594274,10.40115605525567,-1.058992702146984,23.94053688131975,19.42393128225736,-19.86729001893639,83.51400315054792,53.15067347376799,44.58861230678313,-8.439389413500589,35.21034702119373,11.75285266441434,135.2923835816987,36.74692805608114,65.83003320526659,37.70937666151259,73.15708298044106,103.7959383451022,25.36948449271066,24.08004028566422,14.37084972858429,57.54531258030941,-103.5980383436081,28.54530138617394,102.9179472923279,19.2575248013372,-9.028324833058793,96.92299877719472,18.14138674228749,5.322302248461027,147.1987909723097,7.751852256911142,21.64972634963047,16.24354088900972,122.680671396086,19.08651571937754,-7.887035126327186,99.16678364846834,44.86927078842023,20.75116897611582,14.8436923532775,25.29983117461744,127.3394135695237,-2.906820906168182,17.57630542317691,8.312952255820209,70.75271840082597,35.05923483219553,100.7094821731937,9.904266449712939,34.29492853035706,32.12788997226291,31.23369481640931,54.38752719483089,-3.436,-95.7129,-56.01837398288967,-65.79781784245998,28.8129970945161,29.64058752620921],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["<b>Country:<\/b> albania<br><b>Population:<\/b> 2877239<br><b>Corruption:<\/b> 0.891","<b>Country:<\/b> argentina<br><b>Population:<\/b> 45267449<br><b>Corruption:<\/b> 0.816","<b>Country:<\/b> australia<br><b>Population:<\/b> 25550683<br><b>Corruption:<\/b> 0.491","<b>Country:<\/b> austria<br><b>Population:<\/b> 9015361<br><b>Corruption:<\/b> 0.464","<b>Country:<\/b> bahrain<br><b>Population:<\/b> 1711057<br><b>Corruption:<\/b> NA","<b>Country:<\/b> bangladesh<br><b>Population:<\/b> 164972348<br><b>Corruption:<\/b> 0.742","<b>Country:<\/b> belgium<br><b>Population:<\/b> 11598451<br><b>Corruption:<\/b> 0.634","<b>Country:<\/b> benin<br><b>Population:<\/b> 12175480<br><b>Corruption:<\/b> 0.532","<b>Country:<\/b> bolivia<br><b>Population:<\/b> 11700207<br><b>Corruption:<\/b> 0.868","<b>Country:<\/b> bosnia and herzegovina<br><b>Population:<\/b> 3277152<br><b>Corruption:<\/b> 0.916","<b>Country:<\/b> brazil<br><b>Population:<\/b> 212821986<br><b>Corruption:<\/b> 0.729","<b>Country:<\/b> bulgaria<br><b>Population:<\/b> 6939018<br><b>Corruption:<\/b> 0.901","<b>Country:<\/b> cambodia<br><b>Population:<\/b> 16758448<br><b>Corruption:<\/b> 0.863","<b>Country:<\/b> cameroon<br><b>Population:<\/b> 26655083<br><b>Corruption:<\/b> 0.837","<b>Country:<\/b> canada<br><b>Population:<\/b> 37799407<br><b>Corruption:<\/b> 0.434","<b>Country:<\/b> chile<br><b>Population:<\/b> 19144605<br><b>Corruption:<\/b> 0.812","<b>Country:<\/b> china<br><b>Population:<\/b> 1440297825<br><b>Corruption:<\/b> NA","<b>Country:<\/b> colombia<br><b>Population:<\/b> 50976248<br><b>Corruption:<\/b> 0.808","<b>Country:<\/b> croatia<br><b>Population:<\/b> 4100719<br><b>Corruption:<\/b> 0.961","<b>Country:<\/b> cyprus<br><b>Population:<\/b> 1208886<br><b>Corruption:<\/b> 0.816","<b>Country:<\/b> denmark<br><b>Population:<\/b> 5795780<br><b>Corruption:<\/b> 0.214","<b>Country:<\/b> dominican republic<br><b>Population:<\/b> 10866667<br><b>Corruption:<\/b> 0.636","<b>Country:<\/b> ecuador<br><b>Population:<\/b> 17688599<br><b>Corruption:<\/b> 0.855","<b>Country:<\/b> egypt<br><b>Population:<\/b> 102659126<br><b>Corruption:<\/b> NA","<b>Country:<\/b> el salvador<br><b>Population:<\/b> 6491923<br><b>Corruption:<\/b> 0.583","<b>Country:<\/b> estonia<br><b>Population:<\/b> 1326693<br><b>Corruption:<\/b> 0.398","<b>Country:<\/b> ethiopia<br><b>Population:<\/b> 115434444<br><b>Corruption:<\/b> 0.784","<b>Country:<\/b> finland<br><b>Population:<\/b> 5542237<br><b>Corruption:<\/b> 0.164","<b>Country:<\/b> france<br><b>Population:<\/b> 65298930<br><b>Corruption:<\/b> 0.565","<b>Country:<\/b> georgia<br><b>Population:<\/b> 3987805<br><b>Corruption:<\/b> 0.583","<b>Country:<\/b> germany<br><b>Population:<\/b> 83830972<br><b>Corruption:<\/b> 0.424","<b>Country:<\/b> ghana<br><b>Population:<\/b> 31181428<br><b>Corruption:<\/b> 0.847","<b>Country:<\/b> greece<br><b>Population:<\/b> 10413936<br><b>Corruption:<\/b> 0.764","<b>Country:<\/b> hungary<br><b>Population:<\/b> 9655983<br><b>Corruption:<\/b> 0.836","<b>Country:<\/b> iceland<br><b>Population:<\/b> 341628<br><b>Corruption:<\/b> 0.644","<b>Country:<\/b> india<br><b>Population:<\/b> 1382345085<br><b>Corruption:<\/b> 0.78","<b>Country:<\/b> iran<br><b>Population:<\/b> 84176929<br><b>Corruption:<\/b> 0.71","<b>Country:<\/b> iraq<br><b>Population:<\/b> 40372771<br><b>Corruption:<\/b> 0.849","<b>Country:<\/b> ireland<br><b>Population:<\/b> 4947267<br><b>Corruption:<\/b> 0.356","<b>Country:<\/b> israel<br><b>Population:<\/b> 8678517<br><b>Corruption:<\/b> 0.748","<b>Country:<\/b> italy<br><b>Population:<\/b> 60446035<br><b>Corruption:<\/b> 0.844","<b>Country:<\/b> japan<br><b>Population:<\/b> 126407422<br><b>Corruption:<\/b> 0.609","<b>Country:<\/b> jordan<br><b>Population:<\/b> 10220604<br><b>Corruption:<\/b> NA","<b>Country:<\/b> kazakhstan<br><b>Population:<\/b> 18815231<br><b>Corruption:<\/b> 0.661","<b>Country:<\/b> kenya<br><b>Population:<\/b> 53968739<br><b>Corruption:<\/b> 0.837","<b>Country:<\/b> kyrgyzstan<br><b>Population:<\/b> 6542426<br><b>Corruption:<\/b> 0.931","<b>Country:<\/b> laos<br><b>Population:<\/b> 7293542<br><b>Corruption:<\/b> 0.748","<b>Country:<\/b> latvia<br><b>Population:<\/b> 1882408<br><b>Corruption:<\/b> 0.809","<b>Country:<\/b> lithuania<br><b>Population:<\/b> 2715340<br><b>Corruption:<\/b> 0.829","<b>Country:<\/b> malta<br><b>Population:<\/b> 441750<br><b>Corruption:<\/b> 0.675","<b>Country:<\/b> mauritius<br><b>Population:<\/b> 1272140<br><b>Corruption:<\/b> 0.772","<b>Country:<\/b> mexico<br><b>Population:<\/b> 129166028<br><b>Corruption:<\/b> 0.778","<b>Country:<\/b> moldova<br><b>Population:<\/b> 4032294<br><b>Corruption:<\/b> 0.941","<b>Country:<\/b> mongolia<br><b>Population:<\/b> 3287242<br><b>Corruption:<\/b> 0.843","<b>Country:<\/b> montenegro<br><b>Population:<\/b> 628080<br><b>Corruption:<\/b> 0.845","<b>Country:<\/b> morocco<br><b>Population:<\/b> 36985624<br><b>Corruption:<\/b> 0.803","<b>Country:<\/b> myanmar<br><b>Population:<\/b> 54473253<br><b>Corruption:<\/b> 0.647","<b>Country:<\/b> namibia<br><b>Population:<\/b> 2548663<br><b>Corruption:<\/b> 0.81","<b>Country:<\/b> netherlands<br><b>Population:<\/b> 17141544<br><b>Corruption:<\/b> 0.281","<b>Country:<\/b> new zealand<br><b>Population:<\/b> 4829021<br><b>Corruption:<\/b> 0.283","<b>Country:<\/b> nigeria<br><b>Population:<\/b> 206984347<br><b>Corruption:<\/b> 0.913","<b>Country:<\/b> north macedonia<br><b>Population:<\/b> 2083359<br><b>Corruption:<\/b> 0.877","<b>Country:<\/b> norway<br><b>Population:<\/b> 5428594<br><b>Corruption:<\/b> 0.271","<b>Country:<\/b> philippines<br><b>Population:<\/b> 109830324<br><b>Corruption:<\/b> 0.744","<b>Country:<\/b> poland<br><b>Population:<\/b> 37839255<br><b>Corruption:<\/b> 0.787","<b>Country:<\/b> portugal<br><b>Population:<\/b> 10191409<br><b>Corruption:<\/b> 0.867","<b>Country:<\/b> russia<br><b>Population:<\/b> 145945524<br><b>Corruption:<\/b> 0.823","<b>Country:<\/b> saudi arabia<br><b>Population:<\/b> 34905942<br><b>Corruption:<\/b> NA","<b>Country:<\/b> serbia<br><b>Population:<\/b> 8731081<br><b>Corruption:<\/b> 0.824","<b>Country:<\/b> slovenia<br><b>Population:<\/b> 2078989<br><b>Corruption:<\/b> 0.797","<b>Country:<\/b> south africa<br><b>Population:<\/b> 59436725<br><b>Corruption:<\/b> 0.912","<b>Country:<\/b> south korea<br><b>Population:<\/b> 51276977<br><b>Corruption:<\/b> 0.665","<b>Country:<\/b> spain<br><b>Population:<\/b> 46757980<br><b>Corruption:<\/b> 0.73","<b>Country:<\/b> sweden<br><b>Population:<\/b> 10110233<br><b>Corruption:<\/b> 0.203","<b>Country:<\/b> switzerland<br><b>Population:<\/b> 8665615<br><b>Corruption:<\/b> 0.28","<b>Country:<\/b> tajikistan<br><b>Population:<\/b> 9573310<br><b>Corruption:<\/b> 0.55","<b>Country:<\/b> tanzania<br><b>Population:<\/b> 60012400<br><b>Corruption:<\/b> 0.521","<b>Country:<\/b> thailand<br><b>Population:<\/b> 69830779<br><b>Corruption:<\/b> 0.918","<b>Country:<\/b> tunisia<br><b>Population:<\/b> 11839918<br><b>Corruption:<\/b> 0.877","<b>Country:<\/b> turkey<br><b>Population:<\/b> 84495243<br><b>Corruption:<\/b> 0.774","<b>Country:<\/b> uganda<br><b>Population:<\/b> 45974931<br><b>Corruption:<\/b> 0.878","<b>Country:<\/b> ukraine<br><b>Population:<\/b> 43686577<br><b>Corruption:<\/b> 0.946","<b>Country:<\/b> united arab emirates<br><b>Population:<\/b> 9910892<br><b>Corruption:<\/b> NA","<b>Country:<\/b> united kingdom<br><b>Population:<\/b> 67948282<br><b>Corruption:<\/b> 0.49","<b>Country:<\/b> united states<br><b>Population:<\/b> 331341050<br><b>Corruption:<\/b> 0.678","<b>Country:<\/b> uruguay<br><b>Population:<\/b> 3475842<br><b>Corruption:<\/b> 0.491","<b>Country:<\/b> venezuela<br><b>Population:<\/b> 28421581<br><b>Corruption:<\/b> 0.811","<b>Country:<\/b> zambia<br><b>Population:<\/b> 18468257<br><b>Corruption:<\/b> 0.81","<b>Country:<\/b> zimbabwe<br><b>Population:<\/b> 14899771<br><b>Corruption:<\/b> 0.789"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"setView":[[30,0],2,[]],"limits":{"lat":[-44.84064491534399,69.87699814611479],"lng":[-103.5980383436081,147.1987909723097]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="interactive-plot" class="level2">
<h2 class="anchored" data-anchor-id="interactive-plot">Interactive plot</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://r-graph-gallery.com/interactive-charts.html</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#creating a subset </span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>selected_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Afghanistan"</span>, <span class="st">"United States"</span>, <span class="st">"China"</span>, <span class="st">"Ireland"</span>, <span class="st">"India"</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset where the "Country.name" is in the selected countries list</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>subset_file2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(file2, Country.name <span class="sc">%in%</span> selected_countries)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># View the subset</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(subset_file2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Country.name year Life.Ladder Log.GDP.per.capita Social.support
1      Afghanistan 2008       3.724              7.370          0.451
2      Afghanistan 2009       4.402              7.540          0.552
3      Afghanistan 2010       4.758              7.647          0.539
4      Afghanistan 2011       3.832              7.620          0.521
5      Afghanistan 2012       3.783              7.705          0.521
6      Afghanistan 2013       3.572              7.725          0.484
7      Afghanistan 2014       3.131              7.718          0.526
8      Afghanistan 2015       3.983              7.702          0.529
9      Afghanistan 2016       4.220              7.697          0.559
10     Afghanistan 2017       2.662              7.697          0.491
11     Afghanistan 2018       2.694              7.692          0.508
12     Afghanistan 2019       2.375              7.697          0.420
343          China 2006       4.560              8.696          0.747
344          China 2007       4.863              8.824          0.811
345          China 2008       4.846              8.911          0.748
346          China 2009       4.454              8.996          0.798
347          China 2010       4.653              9.092          0.768
348          China 2011       5.037              9.179          0.787
349          China 2012       5.095              9.249          0.788
350          China 2013       5.241              9.319          0.778
351          China 2014       5.196              9.386          0.820
352          China 2015       5.304              9.449          0.794
353          China 2016       5.325              9.510          0.742
354          China 2017       5.099              9.571          0.772
355          China 2018       5.131              9.632          0.788
356          China 2019       5.144              9.688          0.822
357          China 2020       5.771              9.702          0.808
733          India 2006       5.348              8.145          0.707
734          India 2007       5.027              8.204          0.569
735          India 2008       5.146              8.220          0.684
736          India 2009       4.522              8.281          0.653
737          India 2010       4.989              8.349          0.605
738          India 2011       4.635              8.387          0.553
739          India 2012       4.720              8.428          0.511
740          India 2013       4.428              8.478          0.553
741          India 2014       4.424              8.538          0.621
742          India 2015       4.342              8.604          0.610
743          India 2016       4.179              8.673          0.614
744          India 2017       4.046              8.730          0.607
745          India 2018       3.818              8.779          0.638
746          India 2019       3.249              8.818          0.561
747          India 2020       4.225              8.703          0.617
787        Ireland 2006       7.144             10.972          0.967
788        Ireland 2008       7.568             10.929          0.983
789        Ireland 2009       7.046             10.866          0.959
790        Ireland 2010       7.257             10.879          0.973
791        Ireland 2011       7.007             10.878          0.977
792        Ireland 2012       6.965             10.876          0.962
793        Ireland 2013       6.760             10.884          0.955
794        Ireland 2014       7.018             10.959          0.968
795        Ireland 2015       6.830             11.174          0.953
796        Ireland 2016       7.041             11.199          0.958
797        Ireland 2017       7.060             11.266          0.943
798        Ireland 2018       6.962             11.332          0.938
799        Ireland 2019       7.255             11.371          0.944
800        Ireland 2020       7.035             11.323          0.960
1837 United States 2006       7.182             10.924          0.965
1838 United States 2007       7.513             10.933             NA
1839 United States 2008       7.280             10.922          0.953
1840 United States 2009       7.158             10.888          0.912
1841 United States 2010       7.164             10.905          0.926
1842 United States 2011       7.115             10.913          0.922
1843 United States 2012       7.026             10.928          0.903
1844 United States 2013       7.249             10.939          0.925
1845 United States 2014       7.151             10.956          0.902
1846 United States 2015       6.864             10.977          0.904
1847 United States 2016       6.804             10.986          0.897
1848 United States 2017       6.992             11.001          0.921
1849 United States 2018       6.883             11.025          0.904
1850 United States 2019       6.944             11.043          0.917
1851 United States 2020       7.028             11.001          0.937
     Healthy.life.expectancy.at.birth Freedom.to.make.life.choices Generosity
1                               50.80                        0.718      0.168
2                               51.20                        0.679      0.190
3                               51.60                        0.600      0.121
4                               51.92                        0.496      0.162
5                               52.24                        0.531      0.236
6                               52.56                        0.578      0.061
7                               52.88                        0.509      0.104
8                               53.20                        0.389      0.080
9                               53.00                        0.523      0.042
10                              52.80                        0.427     -0.121
11                              52.60                        0.374     -0.094
12                              52.40                        0.394     -0.108
343                             66.88                           NA         NA
344                             67.06                           NA     -0.176
345                             67.24                        0.853     -0.092
346                             67.42                        0.771     -0.160
347                             67.60                        0.805     -0.133
348                             67.76                        0.824     -0.186
349                             67.92                        0.808     -0.185
350                             68.08                        0.805     -0.158
351                             68.24                           NA     -0.217
352                             68.40                           NA     -0.244
353                             68.70                           NA     -0.228
354                             69.00                        0.878     -0.175
355                             69.30                        0.895     -0.159
356                             69.60                        0.927     -0.173
357                             69.90                        0.891     -0.103
733                             55.72                        0.774         NA
734                             56.14                        0.729     -0.051
735                             56.56                        0.756     -0.072
736                             56.98                        0.679     -0.026
737                             57.40                        0.783      0.058
738                             57.70                        0.838     -0.038
739                             58.00                        0.609      0.067
740                             58.30                        0.740      0.084
741                             58.60                        0.809     -0.026
742                             58.90                        0.777     -0.005
743                             59.30                        0.820      0.046
744                             59.70                        0.886     -0.042
745                             60.10                        0.890      0.085
746                             60.50                        0.876      0.112
747                             60.90                        0.906      0.075
787                             70.14                        0.943      0.242
788                             70.82                        0.894      0.322
789                             71.16                        0.835      0.315
790                             71.50                        0.856      0.348
791                             71.60                        0.952      0.383
792                             71.70                        0.902      0.302
793                             71.80                        0.884      0.331
794                             71.90                        0.922      0.264
795                             72.00                        0.892      0.233
796                             72.10                        0.875      0.174
797                             72.20                        0.905      0.216
798                             72.30                        0.861      0.144
799                             72.40                        0.892      0.074
800                             72.50                        0.882      0.014
1837                            68.06                        0.911         NA
1838                            68.22                        0.872      0.197
1839                            68.38                        0.878      0.255
1840                            68.54                        0.831      0.201
1841                            68.70                        0.828      0.244
1842                            68.68                        0.863      0.161
1843                            68.66                        0.823      0.215
1844                            68.64                        0.792      0.274
1845                            68.62                        0.866      0.221
1846                            68.60                        0.849      0.219
1847                            68.50                        0.758      0.144
1848                            68.40                        0.868      0.197
1849                            68.30                        0.825      0.116
1850                            68.20                        0.836      0.144
1851                            68.10                        0.850      0.034
     Perceptions.of.corruption Positive.affect Negative.affect
1                        0.882           0.518           0.258
2                        0.850           0.584           0.237
3                        0.707           0.618           0.275
4                        0.731           0.611           0.267
5                        0.776           0.710           0.268
6                        0.823           0.621           0.273
7                        0.871           0.532           0.375
8                        0.881           0.554           0.339
9                        0.793           0.565           0.348
10                       0.954           0.496           0.371
11                       0.928           0.424           0.405
12                       0.924           0.351           0.502
343                         NA           0.809           0.170
344                         NA           0.817           0.159
345                         NA           0.817           0.147
346                         NA           0.786           0.162
347                         NA           0.765           0.158
348                         NA           0.820           0.134
349                         NA           0.821           0.159
350                         NA           0.836           0.142
351                         NA           0.854           0.112
352                         NA           0.809           0.171
353                         NA           0.826           0.146
354                         NA           0.821           0.214
355                         NA           0.856           0.190
356                         NA           0.891           0.147
357                         NA           0.789           0.245
733                      0.855           0.687           0.199
734                      0.862           0.668           0.253
735                      0.891           0.674           0.259
736                      0.895           0.771           0.301
737                      0.863           0.697           0.267
738                      0.908           0.648           0.232
739                      0.830           0.629           0.295
740                      0.832           0.680           0.330
741                      0.832           0.711           0.285
742                      0.776           0.701           0.322
743                      0.765           0.695           0.346
744                      0.781           0.682           0.318
745                      0.805           0.657           0.357
746                      0.752           0.648           0.466
747                      0.780           0.752           0.383
787                      0.473           0.878           0.209
788                      0.487           0.875           0.148
789                      0.580           0.862           0.233
790                      0.618           0.876           0.201
791                      0.590           0.865           0.190
792                      0.573           0.835           0.237
793                      0.558           0.814           0.245
794                      0.406           0.784           0.229
795                      0.409           0.799           0.225
796                      0.399           0.809           0.211
797                      0.337           0.833           0.213
798                      0.362           0.811           0.213
799                      0.373           0.807           0.223
800                      0.356           0.797           0.246
1837                     0.600           0.827           0.261
1838                     0.633           0.829           0.232
1839                     0.668           0.872           0.227
1840                     0.665           0.843           0.262
1841                     0.690           0.861           0.231
1842                     0.697           0.836           0.273
1843                     0.710           0.834           0.260
1844                     0.747           0.814           0.260
1845                     0.702           0.834           0.281
1846                     0.698           0.814           0.275
1847                     0.739           0.806           0.264
1848                     0.681           0.827           0.268
1849                     0.710           0.815           0.292
1850                     0.707           0.815           0.244
1851                     0.678           0.787           0.295</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#creating interactive graph</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'subset_file2' is your dataframe</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plotly plot</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(subset_file2, <span class="at">x =</span> <span class="sc">~</span>year, <span class="at">y =</span> <span class="sc">~</span>Healthy.life.expectancy.at.birth, </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="sc">~</span>Country.name, <span class="at">text =</span> <span class="sc">~</span>Country.name) <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Healthy Life Expectancy at Birth Over Years"</span>,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Healthy Life Expectancy at Birth"</span>),</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">hovermode =</span> <span class="st">"closest"</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the interactive plot to an HTML file</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(fig, <span class="st">"fig.html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<iframe src="fig.html" width="100%" height="500" style="border:none;"></iframe>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset </span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>top_5_populated <span class="ot">&lt;-</span> <span class="fu">head</span>(country_data[<span class="fu">order</span>(<span class="sc">-</span>country_data<span class="sc">$</span>population), ], <span class="dv">5</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_5_populated, <span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> population, <span class="at">fill =</span> country)) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> population), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Population"</span>, <span class="at">title =</span> <span class="st">"Population of Top 5 Countries"</span>) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_5_populated, <span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> life_expectancy, <span class="at">fill =</span> country)) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> life_expectancy), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Life Expectancy"</span>, <span class="at">title =</span> <span class="st">"Life Expectancy of Top 5 populated Countries"</span>) <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>top_20_populated <span class="ot">&lt;-</span> <span class="fu">head</span>(country_data[<span class="fu">order</span>(<span class="sc">-</span>country_data<span class="sc">$</span>population), ], <span class="dv">20</span>)  </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_20_populated, <span class="fu">aes</span>(<span class="at">x =</span> fertility_rate, <span class="at">y =</span> life_expectancy, <span class="at">size =</span> population, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Add country labels</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fertility Rate vs. Life Expectancy for Selected countries"</span>,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fertility Rate"</span>,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Life Expectancy"</span>) <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot for life expectancy</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(country_data, <span class="fu">aes</span>(<span class="at">y =</span> life_expectancy)) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plot of Life Expectancy"</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot for generosity</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(country_data, <span class="fu">aes</span>(<span class="at">y =</span> generosity)) <span class="sc">+</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"pink"</span>) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plot of Generosity"</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot for corruption</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(country_data, <span class="fu">aes</span>(<span class="at">y =</span> corruption)) <span class="sc">+</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">fill =</span> <span class="st">"lavender"</span>) <span class="sc">+</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plot of Corruption"</span>)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot for fertility rate</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(country_data, <span class="fu">aes</span>(<span class="at">y =</span> fertility_rate)) <span class="sc">+</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">fill =</span> <span class="st">"peachpuff"</span>) <span class="sc">+</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plot of Fertility Rate"</span>)</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots in one image</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(plot1, plot2, plot3, plot4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div class="cell">
<details>
<summary>Code</summary>
<pre class="bibliography cell-code"><code></code></pre>
</details>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>