<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MS5130_3rd_Assignment_23105421</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="23105421_quarto_files/libs/clipboard/clipboard.min.js"></script>
<script src="23105421_quarto_files/libs/quarto-html/quarto.js"></script>
<script src="23105421_quarto_files/libs/quarto-html/popper.min.js"></script>
<script src="23105421_quarto_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="23105421_quarto_files/libs/quarto-html/anchor.min.js"></script>
<link href="23105421_quarto_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="23105421_quarto_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="23105421_quarto_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="23105421_quarto_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="23105421_quarto_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="23105421_quarto_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="23105421_quarto_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="23105421_quarto_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="23105421_quarto_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="23105421_quarto_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="23105421_quarto_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="23105421_quarto_files/libs/leaflet-1.3.1/leaflet.js"></script>
<link href="23105421_quarto_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="23105421_quarto_files/libs/proj4-2.6.2/proj4.min.js"></script>
<script src="23105421_quarto_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="23105421_quarto_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="23105421_quarto_files/libs/leaflet-binding-2.2.2/leaflet.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#part-a" id="toc-part-a" class="nav-link" data-scroll-target="#part-a">Part A</a>
  <ul class="collapse">
  <li><a href="#importing-files" id="toc-importing-files" class="nav-link" data-scroll-target="#importing-files">Importing files</a></li>
  <li><a href="#preprosseing-dataset" id="toc-preprosseing-dataset" class="nav-link" data-scroll-target="#preprosseing-dataset">Preprosseing dataset</a></li>
  <li><a href="#joining-datasets" id="toc-joining-datasets" class="nav-link" data-scroll-target="#joining-datasets">Joining Datasets</a></li>
  <li><a href="#quantitative-analysis" id="toc-quantitative-analysis" class="nav-link" data-scroll-target="#quantitative-analysis">Quantitative Analysis</a>
  <ul class="collapse">
  <li><a href="#glm-model" id="toc-glm-model" class="nav-link" data-scroll-target="#glm-model">GLM model</a></li>
  <li><a href="#gam-model" id="toc-gam-model" class="nav-link" data-scroll-target="#gam-model">GAM model</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-b" id="toc-part-b" class="nav-link" data-scroll-target="#part-b">Part B</a>
  <ul class="collapse">
  <li><a href="#mermaid-design" id="toc-mermaid-design" class="nav-link" data-scroll-target="#mermaid-design">Mermaid design</a></li>
  <li><a href="#leaflet-analysis" id="toc-leaflet-analysis" class="nav-link" data-scroll-target="#leaflet-analysis">Leaflet Analysis</a>
  <ul class="collapse">
  <li><a href="#adding-latitude-and-longitude" id="toc-adding-latitude-and-longitude" class="nav-link" data-scroll-target="#adding-latitude-and-longitude">Adding Latitude and Longitude</a></li>
  <li><a href="#geographical-analysis" id="toc-geographical-analysis" class="nav-link" data-scroll-target="#geographical-analysis">Geographical Analysis</a></li>
  </ul></li>
  <li><a href="#interactive-plot" id="toc-interactive-plot" class="nav-link" data-scroll-target="#interactive-plot">Interactive plot</a></li>
  </ul></li>
  <li><a href="#part-c" id="toc-part-c" class="nav-link" data-scroll-target="#part-c">Part C</a>
  <ul class="collapse">
  <li><a href="#bar-plot-population-of-top-5-countries" id="toc-bar-plot-population-of-top-5-countries" class="nav-link" data-scroll-target="#bar-plot-population-of-top-5-countries">Bar Plot-Population of Top 5 Countries</a></li>
  <li><a href="#bar-plot-life-expectancy-of-top-5-populated-countries" id="toc-bar-plot-life-expectancy-of-top-5-populated-countries" class="nav-link" data-scroll-target="#bar-plot-life-expectancy-of-top-5-populated-countries">Bar Plot-Life Expectancy of Top 5 populated Countries</a></li>
  <li><a href="#scattered-plot-fertility-rate-vs.-life-expectancy-for-selected-countries" id="toc-scattered-plot-fertility-rate-vs.-life-expectancy-for-selected-countries" class="nav-link" data-scroll-target="#scattered-plot-fertility-rate-vs.-life-expectancy-for-selected-countries">Scattered Plot-Fertility Rate vs.&nbsp;Life Expectancy for Selected countries</a></li>
  <li><a href="#box-plots" id="toc-box-plots" class="nav-link" data-scroll-target="#box-plots">Box plots</a></li>
  </ul></li>
  <li><a href="#part-d-notes" id="toc-part-d-notes" class="nav-link" data-scroll-target="#part-d-notes">Part D-Notes</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MS5130_3rd_Assignment_23105421</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="logo.png" title="University of Galway" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Author: Anup Kamath</figcaption>
</figure>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<div style="text-align: justify;">
<p>Greetings, this document has been crafted to satisfy the criteria of the MS5130 course, Applied Analytics in Business and Society. It encompasses a range of analyses including quantitative analysis, visualization utilizing the leaflet package, interactive graphs, and fundamental visualizations.</p>
</div>
</section>
<section id="part-a" class="level1">
<h1>Part A</h1>
<div style="text-align: justify;">
<p>In Part I, I will showcase some of the basic enhancements (BEs) I have implemented. These enhancements primarily involve utilizing Markdown, Quarto, dataset reading, preprocessing, merging, and conducting quantitative analysis</p>
</div>
<section id="importing-files" class="level2">
<h2 class="anchored" data-anchor-id="importing-files">Importing files</h2>
<div style="text-align: justify;">
<p>The initial steps involve establishing the directory and importing necessary files. The data-sets essential for the analysis were sourced from <span class="citation" data-cites="joshuaswords_awesome-eda-2021-happiness-population">Words (<a href="#ref-joshuaswords_awesome-eda-2021-happiness-population" role="doc-biblioref">2021</a>)</span> . The data-set contains information on various parameters such as life expectancy, fertility rate, corruption, etc., pertaining to different countries.This will full-fill our BE2- Use multiple data-sets task.</p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"the current directory is"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "the current directory is"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/ANUP KAMATH/Documents/GitHub/R-Assignment"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Lets set the directory as per our requirement"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lets set the directory as per our requirement"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/ANUP KAMATH/Documents/GitHub/R-Assignment"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The new directory is"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The new directory is"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/ANUP KAMATH/Documents/GitHub/R-Assignment"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#importing 1st file</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>file1<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"C:/Users/ANUP KAMATH/Desktop/children-born-per-woman.csv"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The first few rows of 1st file are"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The first few rows of 1st file are"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(file1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       Entity Code Year Fertility.rate..Gapminder..v12..2017.
1 Afghanistan  AFG 1950                                  7.57
2 Afghanistan  AFG 1951                                  7.56
3 Afghanistan  AFG 1952                                  7.55
4 Afghanistan  AFG 1953                                  7.54
5 Afghanistan  AFG 1954                                  7.53
6 Afghanistan  AFG 1955                                  7.52</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#importing 2nd file</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>file2<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"C:/Users/ANUP KAMATH/Desktop/world-happiness-report.csv"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The first few rows of 2nd file are"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The first few rows of 2nd file are"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(file2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Country.name year Life.Ladder Log.GDP.per.capita Social.support
1  Afghanistan 2008       3.724              7.370          0.451
2  Afghanistan 2009       4.402              7.540          0.552
3  Afghanistan 2010       4.758              7.647          0.539
4  Afghanistan 2011       3.832              7.620          0.521
5  Afghanistan 2012       3.783              7.705          0.521
6  Afghanistan 2013       3.572              7.725          0.484
  Healthy.life.expectancy.at.birth Freedom.to.make.life.choices Generosity
1                            50.80                        0.718      0.168
2                            51.20                        0.679      0.190
3                            51.60                        0.600      0.121
4                            51.92                        0.496      0.162
5                            52.24                        0.531      0.236
6                            52.56                        0.578      0.061
  Perceptions.of.corruption Positive.affect Negative.affect
1                     0.882           0.518           0.258
2                     0.850           0.584           0.237
3                     0.707           0.618           0.275
4                     0.731           0.611           0.267
5                     0.776           0.710           0.268
6                     0.823           0.621           0.273</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#importing 3rd file</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>file3<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"C:/Users/ANUP KAMATH/Desktop/population_by_country_2020.csv"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The first few rows of 3rd file are"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The first few rows of 3rd file are"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(file3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Country..or.dependency. Population..2020. Yearly.Change Net.Change
1                   China        1440297825        0.39 %    5540090
2                   India        1382345085        0.99 %   13586631
3           United States         331341050        0.59 %    1937734
4               Indonesia         274021604        1.07 %    2898047
5                Pakistan         221612785        2.00 %    4327022
6                  Brazil         212821986        0.72 %    1509890
  Density..P.Km.. Land.Area..Km.. Migrants..net. Fert..Rate Med..Age
1             153         9388211        -348399        1.7       38
2             464         2973190        -532687        2.2       28
3              36         9147420         954806        1.8       38
4             151         1811570         -98955        2.3       30
5             287          770880        -233379        3.6       23
6              25         8358140          21200        1.7       33
  Urban.Pop.. World.Share
1        61 %     18.47 %
2        35 %     17.70 %
3        83 %      4.25 %
4        56 %      3.51 %
5        35 %      2.83 %
6        88 %      2.73 %</code></pre>
</div>
</div>
</section>
<section id="preprosseing-dataset" class="level2">
<h2 class="anchored" data-anchor-id="preprosseing-dataset">Preprosseing dataset</h2>
<div style="text-align: justify;">
<p>Now, let’s preprocess the data to facilitate easy joining. We have selected only the columns necessary for our analysis, and the rest have been dropped. We have only retained data with respect to year 2020. The names of the columns has been changed.</p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#file 1 changes</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>subset_a_2020 <span class="ot">&lt;-</span> file1[file1<span class="sc">$</span>Year <span class="sc">==</span> <span class="dv">2020</span>, ]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#head(subset_a_2020)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>subset_a_2020 <span class="ot">&lt;-</span> subset_a_2020[, <span class="fu">c</span>(<span class="st">"Entity"</span>, <span class="st">"Code"</span>, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Fertility.rate..Gapminder..v12..2017."</span>)]</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(subset_a_2020) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"code"</span>, <span class="st">"fertility_rate"</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The new modified file 1 data-setlooks like this"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The new modified file 1 data-setlooks like this"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subset_a_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                country code fertility_rate
71          Afghanistan  AFG           4.04
162             Albania  ALB           1.70
235             Algeria  DZA           2.54
308              Angola  AGO           5.41
381 Antigua and Barbuda  ATG           2.01
535           Argentina  ARG           2.23</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#file 2 changes</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>subset_b_2020 <span class="ot">&lt;-</span> file2[file2<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2020</span>, ]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View the subset</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#head(subset_b_2020)</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>subset_b_2020 <span class="ot">&lt;-</span> subset_b_2020[, <span class="fu">c</span>(<span class="st">"Country.name"</span>, <span class="st">"Healthy.life.expectancy.at.birth"</span>, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Freedom.to.make.life.choices"</span>, <span class="st">"Generosity"</span>, </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Perceptions.of.corruption"</span>)]</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(subset_b_2020) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"life_expectancy"</span>, <span class="st">"freedom"</span>,<span class="st">"generosity"</span>,<span class="st">"corruption"</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified subset</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The modified file 2 data-setlooks like this"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The modified file 2 data-setlooks like this"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subset_b_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       country life_expectancy freedom generosity corruption
25     Albania            69.3   0.754      0.007      0.891
52   Argentina            69.2   0.823     -0.122      0.816
80   Australia            74.2   0.905      0.210      0.491
93     Austria            73.6   0.912      0.011      0.464
118    Bahrain            69.7   0.945      0.132         NA
133 Bangladesh            65.3   0.777     -0.009      0.742</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#file 3 changes</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#head(file3)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(file3)</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>subset_c_2020 <span class="ot">&lt;-</span> file3[, <span class="fu">c</span>(<span class="st">"Country..or.dependency."</span>, <span class="st">"Population..2020."</span>, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Density..P.Km.."</span>)]</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(subset_c_2020)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"population"</span>, <span class="st">"density_pkm"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The modified file 3 data-setlooks like this"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The modified file 3 data-setlooks like this"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subset_c_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        country population density_pkm
1         China 1440297825         153
2         India 1382345085         464
3 United States  331341050          36
4     Indonesia  274021604         151
5      Pakistan  221612785         287
6        Brazil  212821986          25</code></pre>
</div>
</div>
</section>
<section id="joining-datasets" class="level2">
<h2 class="anchored" data-anchor-id="joining-datasets">Joining Datasets</h2>
<div style="text-align: justify;">
<p>It’s time to join the 3 data-sets into 1. I have used dplyr libraries inner join to join them. As R is case sensitive I had to change all country names to lower caps to succed in this task.This will full-fill our BE3- Combine data-sets together task.</p>
</div>
<p>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#joining tables</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert country column to lowercase in all dataframes</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>subset_a_2020 <span class="ot">&lt;-</span> subset_a_2020 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">tolower</span>(country))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>subset_b_2020 <span class="ot">&lt;-</span> subset_b_2020 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">tolower</span>(country))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>subset_c_2020 <span class="ot">&lt;-</span> subset_c_2020 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">tolower</span>(country))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">#join data</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>country_data <span class="ot">&lt;-</span> subset_b_2020 <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(subset_a_2020, <span class="at">by =</span> <span class="st">"country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(subset_c_2020, <span class="at">by =</span> <span class="st">"country"</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co">#show new dataset</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The new data-set looks like this"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The new data-set looks like this"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(country_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     country life_expectancy freedom generosity corruption code fertility_rate
1    albania            69.3   0.754      0.007      0.891  ALB           1.70
2  argentina            69.2   0.823     -0.122      0.816  ARG           2.23
3  australia            74.2   0.905      0.210      0.491  AUS           1.81
4    austria            73.6   0.912      0.011      0.464  AUT           1.54
5    bahrain            69.7   0.945      0.132         NA  BHR           1.94
6 bangladesh            65.3   0.777     -0.009      0.742  BGD           2.00
  population density_pkm
1    2877239         105
2   45267449          17
3   25550683           3
4    9015361         109
5    1711057        2239
6  164972348        1265</code></pre>
</div>
</div>
</section>
<section id="quantitative-analysis" class="level2">
<h2 class="anchored" data-anchor-id="quantitative-analysis">Quantitative Analysis</h2>
<div style="text-align: justify;">
<p>Due to the inadequacy of my dataset in producing satisfactory models, I opted to convert my target variable, corruption, into a factor <span class="citation" data-cites="stackoverflow_convert-data-frame-column-format">Overflow (<a href="#ref-stackoverflow_convert-data-frame-column-format" role="doc-biblioref">2012</a>)</span> . With this new column, I proceeded to run GLM and GAM models. As my datasets do not allow for qualitative models like text mining, I focused on satisfying the deliverable (BE4) by incorporating a synergy of quantitative and qualitative analyses through GLM and GAM models.</p>
</div>
<section id="glm-model" class="level3">
<h3 class="anchored" data-anchor-id="glm-model">GLM model</h3>
<div style="text-align: justify;">
<p>A Generalized Linear Model (GLM) is a statistical framework that allows for the analysis of data with diverse response distributions.Here I have used the corruption_factor as a tagert variable and freedom column as the independent variable.</p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#quantitative analysis- glm model</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting corruption into factor inorder to run glm model</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>country_data <span class="ot">&lt;-</span> country_data <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">corruption_factor =</span> <span class="fu">ifelse</span>(corruption <span class="sc">&gt;</span> <span class="fl">0.6</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'corruption_factor' to a factor variable</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>corruption_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(country_data<span class="sc">$</span>corruption_factor)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># running glm model</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and testing sets</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(country_data), <span class="dv">70</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> country_data[sample_indices, ]</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> country_data[<span class="sc">-</span>sample_indices, ]</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the logistic regression model</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>glm_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(corruption_factor <span class="sc">~</span> freedom, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">data =</span> train_data)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the model</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = corruption_factor ~ freedom, family = binomial(link = "logit"), 
    data = train_data)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)    7.448      5.508   1.352    0.176
freedom       -7.542      6.432  -1.173    0.241

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 18.550  on 16  degrees of freedom
Residual deviance: 16.935  on 15  degrees of freedom
  (2 observations deleted due to missingness)
AIC: 20.935

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the model</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(glm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div style="text-align: justify;">
<p>The Fisher Scoring algorithm converged in 4 iterations. The obtained <strong>p-value of 0.176 suggests insignificance</strong>, indicating no significant relationship between corruption and freedom. The null deviance (18.550) and residual deviance (16.593) represent the deviation of the fitted model, with lower values indicating better model fit.</p>
</div>
</section>
<section id="gam-model" class="level3">
<h3 class="anchored" data-anchor-id="gam-model">GAM model</h3>
<div style="text-align: justify;">
<p>A Generalized Additive Model (GAM) is a flexible extension of the Generalized Linear Model (GLM) that incorporates non-linear relationships between predictors and the response variable. The GAM model was built with corruption as the target variable, freedom and generosity were the independent variable.</p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#gam model</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("gam")</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a GAM model</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>gam_model <span class="ot">&lt;-</span> <span class="fu">gam</span>(corruption <span class="sc">~</span> <span class="fu">s</span>(freedom ) <span class="sc">+</span> <span class="fu">s</span>(generosity), <span class="at">data =</span> country_data)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the model</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gam_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
corruption ~ s(freedom) + s(generosity)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.70340    0.01923   36.58   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
               edf Ref.df      F  p-value    
s(freedom)    2.23  2.803 12.819 2.96e-06 ***
s(generosity) 1.00  1.000  0.024    0.877    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =   0.31   Deviance explained = 33.9%
GCV = 0.030496  Scale est. = 0.028842  n = 78</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gam_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div style="text-align: justify;">
<p>The adjusted R-squared is 0.31, indicating that 31% of the variation in corruption is explained by the model. The deviance explained is 33.9%. The smooth term for freedom has an effective degrees of freedom (edf) of 2.23 and a highly significant F-statistic (p &lt; 2.96e-06), suggesting a <strong>non-linear relationship with corruption</strong>. However, the smooth term for <strong>generosity is not significant (p = 0.877), implying a linear relationship</strong>.</p>
</div>
</section>
</section>
</section>
<section id="part-b" class="level1">
<h1>Part B</h1>
<div style="text-align: justify;">
<p>In this sections I will be performing tasks for superior enhancements (SEs)</p>
</div>
<section id="mermaid-design" class="level2">
<h2 class="anchored" data-anchor-id="mermaid-design">Mermaid design</h2>
<div style="text-align: justify;">
<p>The mermaid tool is used to describe the flow of data and also varibles used to do varies analysis and visualization.This task will fulfill the (SE1) Depict your data streams using Mermaid.</p>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">graph LR
     A[children-born-per-woman]-- import data --&gt; D[subset_a_2020]
    B[world-happiness-report]-- import data --&gt; E[subset_b_2020]
    C[population_by_country_2020]-- import data  --&gt; F[subset_c_2020]
    D[subset_a_2020]-- Preprocess data --&gt; M((country_data))
    E[subset_b_2020]-- Preprocess data  --&gt; M((country_data))
    F[subset_c_2020]-- Preprocess data --&gt; M((country_data))
    
   M((country_data))-- GLM model--&gt;G[GLM Model]
   G[GLM Model]-- variables--&gt;H[corruption &amp; Freedom]
    M((country_data))-- GAM model--&gt;I[GAM Model]
   I[GAM Model]-- variables--&gt;J[corruption,generosity &amp; Freedom]

    M((country_data))-- leaflet--&gt;K[ Geographic map]--variables--&gt;WY[Population,Corruption]
    B[world-happiness-report]-- interactive graph --&gt; L[ Scattered plot]
    M((country_data))--&gt;N[Bar plot]--variables--&gt;W[Population]
    M((country_data))--&gt;Y[Bar plot]--variables--&gt;S[Life expectancy]
    M((country_data))--&gt;O[Scattere Plot]--variables--&gt;X[Fertility Rate vs. Life Expectancy]
    M((country_data))--&gt;U[Box Plot]--variables--&gt;R[corruption,generosity,fertility rate,life expectancy]
</pre>
</div>
</div>
</div>
</div>
</section>
<section id="leaflet-analysis" class="level2">
<h2 class="anchored" data-anchor-id="leaflet-analysis">Leaflet Analysis</h2>
<div style="text-align: justify;">
<p>Using Leaflet library we can map various parameters on the world/area maps.This task will fulfill the (SE3) Use of geographical data analysis using Leaflet.</p>
</div>
<section id="adding-latitude-and-longitude" class="level3">
<h3 class="anchored" data-anchor-id="adding-latitude-and-longitude">Adding Latitude and Longitude</h3>
<div style="text-align: justify;">
<p>While doing the analysis I was not able to map parameters on the world map as latitudes and logitude werentpresent in my dataset. I used Generative AI to add these columns to my dataset <span class="citation" data-cites="openai_chatgpt">OpenAI (<a href="#ref-openai_chatgpt" role="doc-biblioref">2024</a>)</span></p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install required packages</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("readr")</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("dplyr")</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidyverse")</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co">#if (!require("tm")) install.packages("tm")</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co">#if (!require("wordcloud")) install.packages("wordcloud")</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co">#if (!require("RColorBrewer")) install.packages("RColorBrewer")</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"leaflet"</span>)) <span class="fu">install.packages</span>(<span class="st">"leaflet"</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"countrycode"</span>)) <span class="fu">install.packages</span>(<span class="st">"countrycode"</span>)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countrycode)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("plotly")</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="co">#head(country_data)</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>world_map <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>)</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert country names in anuata to lowercase</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>country <span class="ot">&lt;-</span> <span class="fu">tolower</span>(country_data<span class="sc">$</span>country)</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert region names in world_map (which represents countries here) to lowercase</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>world_map<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="fu">tolower</span>(world_map<span class="sc">$</span>region)</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="co"># unique list of countries with their mean latitude and longitude</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>country_coords <span class="ot">&lt;-</span> world_map <span class="sc">%&gt;%</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">lat =</span> <span class="fu">mean</span>(lat), <span class="at">lon =</span> <span class="fu">mean</span>(long), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the coordinates</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>country_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(country_data, country_coords, <span class="at">by.x =</span> <span class="st">"country"</span>, <span class="at">by.y =</span> <span class="st">"region"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>non_matching <span class="ot">&lt;-</span> country_data[<span class="fu">is.na</span>(country_data<span class="sc">$</span>lat), <span class="st">"country"</span>]</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(non_matching)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "united kingdom" "united states" </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#US and UK latitude and logitude missing</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">#adding lat &amp; long for US</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>lat <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(country_data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"united states"</span>, <span class="fl">37.0902</span>, country_data<span class="sc">$</span>lat)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>lon <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(country_data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"united states"</span>, <span class="sc">-</span><span class="fl">95.7129</span>, country_data<span class="sc">$</span>lon)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># adding lat &amp; long for Uk</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>lat <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(country_data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"united kingdom"</span>, <span class="fl">55.3781</span>, country_data<span class="sc">$</span>lat)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>country_data<span class="sc">$</span>lon <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(country_data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"united kingdom"</span>, <span class="sc">-</span><span class="fl">3.4360</span>, country_data<span class="sc">$</span>lon)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">#tail(country_data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="geographical-analysis" class="level3">
<h3 class="anchored" data-anchor-id="geographical-analysis">Geographical Analysis</h3>
<div style="text-align: justify;">
<p>The Map visualisation using Leaflet library</p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>world_map_leaflet <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(<span class="at">data =</span> country_data) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>(<span class="at">lng =</span> <span class="dv">0</span>, <span class="at">lat =</span> <span class="dv">30</span>, <span class="at">zoom =</span> <span class="dv">2</span>)  </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>world_map_leaflet <span class="ot">&lt;-</span> world_map_leaflet <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">lng =</span> <span class="sc">~</span>lon,  </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat =</span> <span class="sc">~</span>lat,  </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="st">"&lt;b&gt;Country:&lt;/b&gt; "</span>, country, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"&lt;b&gt;Population:&lt;/b&gt; "</span>, population, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"&lt;b&gt;Corruption:&lt;/b&gt; "</span>, corruption)  </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>world_map_leaflet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-0bb2780fb795d1b48284" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0bb2780fb795d1b48284">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[[41.09708418044369,-37.65934036372371,-25.18299682124491,47.57973189914928,26.05096186124361,23.50905165572961,50.59062728413775,9.734187972788908,-16.55725036739733,44.06762441870284,-9.802374640273657,42.62485704475275,12.59715425914229,6.2606792647498,65.29312210129154,-44.84064491534399,35.08243543758604,3.471104794416583,44.64204021188664,35.06383926391602,55.70473306131043,18.82517881052835,-1.643067240732472,27.6763009761162,13.850656393412,58.53493857750526,9.187706951273988,63.95119464961117,46.16686105018805,42.06423494292468,51.20460854785543,8.321272399568338,38.35875267119733,47.23226486633871,65.30841881286756,23.39336982137758,33.29490974993745,33.78998017208771,53.49476024082729,31.8765000479562,42.16598249235486,35.47392830548769,31.32931371529897,47.90227476086533,0.5784225319574277,40.91947045277075,18.43688927919437,56.86747880663191,55.08303815780148,35.96162700653076,-20.29733768262361,24.21141486238376,47.06327952954593,47.77825516721477,42.8171734602555,28.48567085680754,18.80447879030132,-21.82045585956979,52.09904686948087,-40.86267866811445,8.553471381847675,41.63620866375205,69.87699814611479,11.45729613843372,51.40997793704648,39.93083947704685,63.54476059433037,23.17242342835173,44.25244720687581,46.12320394226999,-28.84654387737291,35.73691086402306,40.67995297908783,61.89590923058444,46.74156613273416,38.95632402166765,-6.550021064408282,13.24865417579466,34.21880424663585,39.06608086718359,1.384924265524993,48.47919870899842,24.25769825711276,55.3781,37.0902,-32.29726104469566,7.398183538169457,-12.50429605489068,-19.14778542799108],[20.10925137680189,-65.45939024557163,136.9985434157885,13.47336568551905,50.5497066791241,90.50611803929012,4.73210363007762,2.359138491607847,-65.12439570814799,18.13478914025712,-55.28056799486398,24.96409570704625,105.1177878401398,13.01387305395944,-89.7561759006016,-72.31060274909524,106.8475748294394,-72.76286862099343,16.34878585682833,33.35030769348145,10.73125458083697,-70.50557947158813,-81.62440596258949,30.79317359773538,-88.81602921357026,24.59475612151317,38.9589723245987,24.43022350839057,3.226979203100416,43.87005075594274,10.40115605525567,-1.058992702146984,23.94053688131975,19.42393128225736,-19.86729001893639,83.51400315054792,53.15067347376799,44.58861230678313,-8.439389413500589,35.21034702119373,11.75285266441434,135.2923835816987,36.74692805608114,65.83003320526659,37.70937666151259,73.15708298044106,103.7959383451022,25.36948449271066,24.08004028566422,14.37084972858429,57.54531258030941,-103.5980383436081,28.54530138617394,102.9179472923279,19.2575248013372,-9.028324833058793,96.92299877719472,18.14138674228749,5.322302248461027,147.1987909723097,7.751852256911142,21.64972634963047,16.24354088900972,122.680671396086,19.08651571937754,-7.887035126327186,99.16678364846834,44.86927078842023,20.75116897611582,14.8436923532775,25.29983117461744,127.3394135695237,-2.906820906168182,17.57630542317691,8.312952255820209,70.75271840082597,35.05923483219553,100.7094821731937,9.904266449712939,34.29492853035706,32.12788997226291,31.23369481640931,54.38752719483089,-3.436,-95.7129,-56.01837398288967,-65.79781784245998,28.8129970945161,29.64058752620921],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["<b>Country:<\/b> albania<br><b>Population:<\/b> 2877239<br><b>Corruption:<\/b> 0.891","<b>Country:<\/b> argentina<br><b>Population:<\/b> 45267449<br><b>Corruption:<\/b> 0.816","<b>Country:<\/b> australia<br><b>Population:<\/b> 25550683<br><b>Corruption:<\/b> 0.491","<b>Country:<\/b> austria<br><b>Population:<\/b> 9015361<br><b>Corruption:<\/b> 0.464","<b>Country:<\/b> bahrain<br><b>Population:<\/b> 1711057<br><b>Corruption:<\/b> NA","<b>Country:<\/b> bangladesh<br><b>Population:<\/b> 164972348<br><b>Corruption:<\/b> 0.742","<b>Country:<\/b> belgium<br><b>Population:<\/b> 11598451<br><b>Corruption:<\/b> 0.634","<b>Country:<\/b> benin<br><b>Population:<\/b> 12175480<br><b>Corruption:<\/b> 0.532","<b>Country:<\/b> bolivia<br><b>Population:<\/b> 11700207<br><b>Corruption:<\/b> 0.868","<b>Country:<\/b> bosnia and herzegovina<br><b>Population:<\/b> 3277152<br><b>Corruption:<\/b> 0.916","<b>Country:<\/b> brazil<br><b>Population:<\/b> 212821986<br><b>Corruption:<\/b> 0.729","<b>Country:<\/b> bulgaria<br><b>Population:<\/b> 6939018<br><b>Corruption:<\/b> 0.901","<b>Country:<\/b> cambodia<br><b>Population:<\/b> 16758448<br><b>Corruption:<\/b> 0.863","<b>Country:<\/b> cameroon<br><b>Population:<\/b> 26655083<br><b>Corruption:<\/b> 0.837","<b>Country:<\/b> canada<br><b>Population:<\/b> 37799407<br><b>Corruption:<\/b> 0.434","<b>Country:<\/b> chile<br><b>Population:<\/b> 19144605<br><b>Corruption:<\/b> 0.812","<b>Country:<\/b> china<br><b>Population:<\/b> 1440297825<br><b>Corruption:<\/b> NA","<b>Country:<\/b> colombia<br><b>Population:<\/b> 50976248<br><b>Corruption:<\/b> 0.808","<b>Country:<\/b> croatia<br><b>Population:<\/b> 4100719<br><b>Corruption:<\/b> 0.961","<b>Country:<\/b> cyprus<br><b>Population:<\/b> 1208886<br><b>Corruption:<\/b> 0.816","<b>Country:<\/b> denmark<br><b>Population:<\/b> 5795780<br><b>Corruption:<\/b> 0.214","<b>Country:<\/b> dominican republic<br><b>Population:<\/b> 10866667<br><b>Corruption:<\/b> 0.636","<b>Country:<\/b> ecuador<br><b>Population:<\/b> 17688599<br><b>Corruption:<\/b> 0.855","<b>Country:<\/b> egypt<br><b>Population:<\/b> 102659126<br><b>Corruption:<\/b> NA","<b>Country:<\/b> el salvador<br><b>Population:<\/b> 6491923<br><b>Corruption:<\/b> 0.583","<b>Country:<\/b> estonia<br><b>Population:<\/b> 1326693<br><b>Corruption:<\/b> 0.398","<b>Country:<\/b> ethiopia<br><b>Population:<\/b> 115434444<br><b>Corruption:<\/b> 0.784","<b>Country:<\/b> finland<br><b>Population:<\/b> 5542237<br><b>Corruption:<\/b> 0.164","<b>Country:<\/b> france<br><b>Population:<\/b> 65298930<br><b>Corruption:<\/b> 0.565","<b>Country:<\/b> georgia<br><b>Population:<\/b> 3987805<br><b>Corruption:<\/b> 0.583","<b>Country:<\/b> germany<br><b>Population:<\/b> 83830972<br><b>Corruption:<\/b> 0.424","<b>Country:<\/b> ghana<br><b>Population:<\/b> 31181428<br><b>Corruption:<\/b> 0.847","<b>Country:<\/b> greece<br><b>Population:<\/b> 10413936<br><b>Corruption:<\/b> 0.764","<b>Country:<\/b> hungary<br><b>Population:<\/b> 9655983<br><b>Corruption:<\/b> 0.836","<b>Country:<\/b> iceland<br><b>Population:<\/b> 341628<br><b>Corruption:<\/b> 0.644","<b>Country:<\/b> india<br><b>Population:<\/b> 1382345085<br><b>Corruption:<\/b> 0.78","<b>Country:<\/b> iran<br><b>Population:<\/b> 84176929<br><b>Corruption:<\/b> 0.71","<b>Country:<\/b> iraq<br><b>Population:<\/b> 40372771<br><b>Corruption:<\/b> 0.849","<b>Country:<\/b> ireland<br><b>Population:<\/b> 4947267<br><b>Corruption:<\/b> 0.356","<b>Country:<\/b> israel<br><b>Population:<\/b> 8678517<br><b>Corruption:<\/b> 0.748","<b>Country:<\/b> italy<br><b>Population:<\/b> 60446035<br><b>Corruption:<\/b> 0.844","<b>Country:<\/b> japan<br><b>Population:<\/b> 126407422<br><b>Corruption:<\/b> 0.609","<b>Country:<\/b> jordan<br><b>Population:<\/b> 10220604<br><b>Corruption:<\/b> NA","<b>Country:<\/b> kazakhstan<br><b>Population:<\/b> 18815231<br><b>Corruption:<\/b> 0.661","<b>Country:<\/b> kenya<br><b>Population:<\/b> 53968739<br><b>Corruption:<\/b> 0.837","<b>Country:<\/b> kyrgyzstan<br><b>Population:<\/b> 6542426<br><b>Corruption:<\/b> 0.931","<b>Country:<\/b> laos<br><b>Population:<\/b> 7293542<br><b>Corruption:<\/b> 0.748","<b>Country:<\/b> latvia<br><b>Population:<\/b> 1882408<br><b>Corruption:<\/b> 0.809","<b>Country:<\/b> lithuania<br><b>Population:<\/b> 2715340<br><b>Corruption:<\/b> 0.829","<b>Country:<\/b> malta<br><b>Population:<\/b> 441750<br><b>Corruption:<\/b> 0.675","<b>Country:<\/b> mauritius<br><b>Population:<\/b> 1272140<br><b>Corruption:<\/b> 0.772","<b>Country:<\/b> mexico<br><b>Population:<\/b> 129166028<br><b>Corruption:<\/b> 0.778","<b>Country:<\/b> moldova<br><b>Population:<\/b> 4032294<br><b>Corruption:<\/b> 0.941","<b>Country:<\/b> mongolia<br><b>Population:<\/b> 3287242<br><b>Corruption:<\/b> 0.843","<b>Country:<\/b> montenegro<br><b>Population:<\/b> 628080<br><b>Corruption:<\/b> 0.845","<b>Country:<\/b> morocco<br><b>Population:<\/b> 36985624<br><b>Corruption:<\/b> 0.803","<b>Country:<\/b> myanmar<br><b>Population:<\/b> 54473253<br><b>Corruption:<\/b> 0.647","<b>Country:<\/b> namibia<br><b>Population:<\/b> 2548663<br><b>Corruption:<\/b> 0.81","<b>Country:<\/b> netherlands<br><b>Population:<\/b> 17141544<br><b>Corruption:<\/b> 0.281","<b>Country:<\/b> new zealand<br><b>Population:<\/b> 4829021<br><b>Corruption:<\/b> 0.283","<b>Country:<\/b> nigeria<br><b>Population:<\/b> 206984347<br><b>Corruption:<\/b> 0.913","<b>Country:<\/b> north macedonia<br><b>Population:<\/b> 2083359<br><b>Corruption:<\/b> 0.877","<b>Country:<\/b> norway<br><b>Population:<\/b> 5428594<br><b>Corruption:<\/b> 0.271","<b>Country:<\/b> philippines<br><b>Population:<\/b> 109830324<br><b>Corruption:<\/b> 0.744","<b>Country:<\/b> poland<br><b>Population:<\/b> 37839255<br><b>Corruption:<\/b> 0.787","<b>Country:<\/b> portugal<br><b>Population:<\/b> 10191409<br><b>Corruption:<\/b> 0.867","<b>Country:<\/b> russia<br><b>Population:<\/b> 145945524<br><b>Corruption:<\/b> 0.823","<b>Country:<\/b> saudi arabia<br><b>Population:<\/b> 34905942<br><b>Corruption:<\/b> NA","<b>Country:<\/b> serbia<br><b>Population:<\/b> 8731081<br><b>Corruption:<\/b> 0.824","<b>Country:<\/b> slovenia<br><b>Population:<\/b> 2078989<br><b>Corruption:<\/b> 0.797","<b>Country:<\/b> south africa<br><b>Population:<\/b> 59436725<br><b>Corruption:<\/b> 0.912","<b>Country:<\/b> south korea<br><b>Population:<\/b> 51276977<br><b>Corruption:<\/b> 0.665","<b>Country:<\/b> spain<br><b>Population:<\/b> 46757980<br><b>Corruption:<\/b> 0.73","<b>Country:<\/b> sweden<br><b>Population:<\/b> 10110233<br><b>Corruption:<\/b> 0.203","<b>Country:<\/b> switzerland<br><b>Population:<\/b> 8665615<br><b>Corruption:<\/b> 0.28","<b>Country:<\/b> tajikistan<br><b>Population:<\/b> 9573310<br><b>Corruption:<\/b> 0.55","<b>Country:<\/b> tanzania<br><b>Population:<\/b> 60012400<br><b>Corruption:<\/b> 0.521","<b>Country:<\/b> thailand<br><b>Population:<\/b> 69830779<br><b>Corruption:<\/b> 0.918","<b>Country:<\/b> tunisia<br><b>Population:<\/b> 11839918<br><b>Corruption:<\/b> 0.877","<b>Country:<\/b> turkey<br><b>Population:<\/b> 84495243<br><b>Corruption:<\/b> 0.774","<b>Country:<\/b> uganda<br><b>Population:<\/b> 45974931<br><b>Corruption:<\/b> 0.878","<b>Country:<\/b> ukraine<br><b>Population:<\/b> 43686577<br><b>Corruption:<\/b> 0.946","<b>Country:<\/b> united arab emirates<br><b>Population:<\/b> 9910892<br><b>Corruption:<\/b> NA","<b>Country:<\/b> united kingdom<br><b>Population:<\/b> 67948282<br><b>Corruption:<\/b> 0.49","<b>Country:<\/b> united states<br><b>Population:<\/b> 331341050<br><b>Corruption:<\/b> 0.678","<b>Country:<\/b> uruguay<br><b>Population:<\/b> 3475842<br><b>Corruption:<\/b> 0.491","<b>Country:<\/b> venezuela<br><b>Population:<\/b> 28421581<br><b>Corruption:<\/b> 0.811","<b>Country:<\/b> zambia<br><b>Population:<\/b> 18468257<br><b>Corruption:<\/b> 0.81","<b>Country:<\/b> zimbabwe<br><b>Population:<\/b> 14899771<br><b>Corruption:<\/b> 0.789"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"setView":[[30,0],2,[]],"limits":{"lat":[-44.84064491534399,69.87699814611479],"lng":[-103.5980383436081,147.1987909723097]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="interactive-plot" class="level2">
<h2 class="anchored" data-anchor-id="interactive-plot">Interactive plot</h2>
<div style="text-align: justify;">
<p>Interactive plot allows you move around in the final output file, like pop-up zoom in zoom out etc. This will full-fill the SE4- Use of interactive charts/graphs/plots task <span class="citation" data-cites="RGraphGallery">R Graph Gallery (<a href="#ref-RGraphGallery" role="doc-biblioref">Accessed 2024</a>)</span></p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#creating a subset </span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>selected_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Afghanistan"</span>, <span class="st">"United States"</span>, <span class="st">"China"</span>, <span class="st">"Ireland"</span>, <span class="st">"India"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset where the "Country.name" is in the selected countries list</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>subset_file2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(file2, Country.name <span class="sc">%in%</span> selected_countries)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View the subset</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co">#print(subset_file2)</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co">#creating interactive graph</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'subset_file2' is your dataframe</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plotly plot</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(subset_file2, <span class="at">x =</span> <span class="sc">~</span>year, <span class="at">y =</span> <span class="sc">~</span>Healthy.life.expectancy.at.birth, </span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="sc">~</span>Country.name, <span class="at">text =</span> <span class="sc">~</span>Country.name) <span class="sc">%&gt;%</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>() <span class="sc">%&gt;%</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Healthy Life Expectancy at Birth Over Years"</span>,</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>),</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Healthy Life Expectancy at Birth"</span>),</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">hovermode =</span> <span class="st">"closest"</span>)</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the interactive plot to an HTML file</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(fig, <span class="st">"fig.html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<iframe src="fig.html" width="100%" height="500" style="border:none;"></iframe>
</section>
</section>
<section id="part-c" class="level1">
<h1>Part C</h1>
<div style="text-align: justify;">
<p>In this section, I will be showing some visualisation, which will give us some valuable insights.</p>
</div>
<section id="bar-plot-population-of-top-5-countries" class="level2">
<h2 class="anchored" data-anchor-id="bar-plot-population-of-top-5-countries">Bar Plot-Population of Top 5 Countries</h2>
<div style="text-align: justify;">
<p>Top 5 countries based on population</p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset </span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>top_5_populated <span class="ot">&lt;-</span> <span class="fu">head</span>(country_data[<span class="fu">order</span>(<span class="sc">-</span>country_data<span class="sc">$</span>population), ], <span class="dv">5</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_5_populated, <span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> population, <span class="at">fill =</span> country)) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> population), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Population"</span>, <span class="at">title =</span> <span class="st">"Population of Top 5 Countries"</span>) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="bar-plot-life-expectancy-of-top-5-populated-countries" class="level2">
<h2 class="anchored" data-anchor-id="bar-plot-life-expectancy-of-top-5-populated-countries">Bar Plot-Life Expectancy of Top 5 populated Countries</h2>
<div style="text-align: justify;">
<p>Life expectancy of the top 5 populated countries</p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_5_populated, <span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> life_expectancy, <span class="at">fill =</span> country)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> life_expectancy), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Life Expectancy"</span>, <span class="at">title =</span> <span class="st">"Life Expectancy of Top 5 populated Countries"</span>) <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="scattered-plot-fertility-rate-vs.-life-expectancy-for-selected-countries" class="level2">
<h2 class="anchored" data-anchor-id="scattered-plot-fertility-rate-vs.-life-expectancy-for-selected-countries">Scattered Plot-Fertility Rate vs.&nbsp;Life Expectancy for Selected countries</h2>
<div style="text-align: justify;">
<p>Scatter plot dpeciting how 20 most populated countries perform with respect to fertility rate and life expectancy.</p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>top_20_populated <span class="ot">&lt;-</span> <span class="fu">head</span>(country_data[<span class="fu">order</span>(<span class="sc">-</span>country_data<span class="sc">$</span>population), ], <span class="dv">20</span>)  </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_20_populated, <span class="fu">aes</span>(<span class="at">x =</span> fertility_rate, <span class="at">y =</span> life_expectancy, <span class="at">size =</span> population, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Add country labels</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fertility Rate vs. Life Expectancy for Selected countries"</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fertility Rate"</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Life Expectancy"</span>) <span class="sc">+</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="box-plots" class="level2">
<h2 class="anchored" data-anchor-id="box-plots">Box plots</h2>
<div style="text-align: justify;">
<p>Box plot for various paramters to know median value and also spread.</p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot for life expectancy</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(country_data, <span class="fu">aes</span>(<span class="at">y =</span> life_expectancy)) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plot of Life Expectancy"</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot for generosity</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(country_data, <span class="fu">aes</span>(<span class="at">y =</span> generosity)) <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"pink"</span>) <span class="sc">+</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plot of Generosity"</span>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot for corruption</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(country_data, <span class="fu">aes</span>(<span class="at">y =</span> corruption)) <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">fill =</span> <span class="st">"lavender"</span>) <span class="sc">+</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plot of Corruption"</span>)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot for fertility rate</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(country_data, <span class="fu">aes</span>(<span class="at">y =</span> fertility_rate)) <span class="sc">+</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">fill =</span> <span class="st">"peachpuff"</span>) <span class="sc">+</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plot of Fertility Rate"</span>)</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots in one image</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(plot1, plot2, plot3, plot4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="23105421_quarto_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="part-d-notes" class="level1">
<h1>Part D-Notes</h1>
<ul>
<li><div style="text-align: justify;">
<ul>
<li><p>Due to limitation with respect to data-set,qualitative analysis couldn’t be performed.</p></li>
<li><p>One of the major limitation of this data-set is it has only 89 columns after joining, hence the model may not be accurate.</p></li>
<li><p>BE1-executing R code in Quarto, BE5-explanatory - has been done throughout the assignment</p></li>
<li><p>The all BE tasks has been performed</p></li>
<li><p>SE2- Use of private Github repository - This has been created recently and has been shared with the Professor.</p></li>
<li><p>Thus SE1,SE2,SE3,SE4 has been completed.</p></li>
<li><p>The video and reference document has been uploaded on canvas</p></li>
<li><p><span class="citation" data-cites="stackoverflow_convert-data-frame-column-format">Overflow (<a href="#ref-stackoverflow_convert-data-frame-column-format" role="doc-biblioref">2012</a>)</span> was used to do basic changes to quarto documents</p></li>
<li><p><span class="citation" data-cites="youtubevideo">Author(s) or Channel Name (<a href="#ref-youtubevideo" role="doc-biblioref">Year Published</a>)</span> was used to add bibliography to this document</p></li>
</ul>
</div></li>
<li><div>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="thank%20you.png" title="Thank you" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Thank you!</figcaption>
</figure>
</div></div></li>
</ul>
</section>
<section id="references" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-youtubevideo" class="csl-entry" role="listitem">
Author(s) or Channel Name. Year Published. <span>“Title of the Video.”</span> <a href="https://www.youtube.com/watch?v=dbljY7jxrSA">https://www.youtube.com/watch?v=dbljY7jxrSA</a>.
</div>
<div id="ref-openai_chatgpt" class="csl-entry" role="listitem">
OpenAI. 2024. <span>“OpenAI ChatGPT.”</span> Online. <a href="https://chat.openai.com/">https://chat.openai.com/</a>.
</div>
<div id="ref-stackoverflow_convert-data-frame-column-format" class="csl-entry" role="listitem">
Overflow, Stack. 2012. <span>“Convert Data Frame Column Format from Character to Factor.”</span> <a href="https://stackoverflow.com/questions/9251326/convert-data-frame-column-format-from-character-to-factor" class="uri">https://stackoverflow.com/questions/9251326/convert-data-frame-column-format-from-character-to-factor</a>.
</div>
<div id="ref-RGraphGallery" class="csl-entry" role="listitem">
R Graph Gallery. Accessed 2024. <span>“Interactive Charts in r.”</span> <a href="https://r-graph-gallery.com/interactive-charts.html" class="uri">https://r-graph-gallery.com/interactive-charts.html</a>.
</div>
<div id="ref-joshuaswords_awesome-eda-2021-happiness-population" class="csl-entry" role="listitem">
Words, Joshua’s. 2021. <span>“Awesome EDA 2021: Happiness &amp; Population.”</span> Kaggle notebook. <a href="https://www.kaggle.com/code/joshuaswords/awesome-eda-2021-happiness-population/notebook">https://www.kaggle.com/code/joshuaswords/awesome-eda-2021-happiness-population/notebook</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>